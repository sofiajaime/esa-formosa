## Introducción a R

R es un conjunto integrado de programas para trabajar con datos, cálculos y gráficos, que permite:
- almacenar y manipular datos,
- operar cálculos sobre variables indexadas (como las matrices),
- analizar datos con una colección de herramientas,
- posibilidades gráficas para el análisis de datos, que funcionan directamente sobre la pantalla y,
- programar con un un lenguaje sencillo y en desarrollo. 

```{r fig.cap= "R", fig.align='center', out.width = '50%', echo=FALSE}
knitr::include_graphics("imagenes/R_logo.svg.png")
```

## El entorno de R

- R se puede entender como el entorno donde se implementan múltiples técnicas estadísticas. El concepto de "entorno" se refiere a que es un sistema diseñado específicamente para el análisis de datos, con coherencia interna que es más que el agregado de cada una de sus herramientas. 

- Gracias a la implementación de R se han desarrollado numerosos métodos interactivos para analizar datos. Los usuarios de R se han ido 'aggiornando' a cada una de las versiones del programa que han ido saliendo que siempre añaden métodos que son acompañados de nuevas tecnologías.

## Aplicar estadística en R

- Como se dijo previamente, el entorno de R permite desplegar técnicas estadísticas, de la más antigua hasta la más actual. Esta ventaja no es proporcional al esfuerzo que implica buscar las herramientas del programa que permiten su aplicación. 

- Lo que diferencia a R de otros sistemas de análisis estadísticos como pueden ser Stata y SPSS es que el output que se genera es poco, comparados con la cantidad de comandos (o "input") que se deben imprimir para obtenerlos. Cada uno de los pasos que se deben seguir para ello, se van almacenando uno a uno en objetos, disponibles para la observación y el análisis del usuario. 

- Algunas técnicas estadísticas están incluidas en el entorno básico de R y otras se pueden obtener en forma de bibliotecas, llamadas "packages" (paquetes).

```{r fig.cap= "R", fig.align='center', out.width = '60%', echo=FALSE}
knitr::include_graphics("imagenes/R_packages.png")
```

## Descargar e instalar R

Para descargar R es posible ingresar a <https://cran.r-project.org/>. Luego, se debe seleccionar el sistema operativo de cada computadora donde se lo desee instalar y, a consiguiente, comenzará la instalación.

```{r fig.cap= "R", fig.align='center', out.width = '80%', echo=FALSE}
knitr::include_graphics("imagenes/R_desc.png")
```

## La interfaz

La manera más sencilla de "comunicarse" con R es:

- escribiendo líneas de comandos que conforman nuestro código en la terminal o bien,
- utilizando una herramienta, denominada técnicamente "interfaz gráfica", que hace más atractiva y fácil la aproximación al programa, llamada R Studio.

```{r fig.cap= "R", fig.align='center', out.width = '80%', echo=FALSE}
knitr::include_graphics("imagenes/terminal.png")
```

## Descargar e instalar RStudio

Se debe ingresar al siguiente enlace: <https://www.rstudio.com/products/rstudio/download/>

```{r fig.cap= "R", fig.align='center', out.width = '10%', echo=FALSE}
knitr::include_graphics("imagenes/RStudio_logo.png")
```

```{r fig.cap= "R", fig.align='center', out.width = '80%', echo=FALSE}
knitr::include_graphics("imagenes/RStudio_desc.png")
```

## Las partes de RStudio

Las secciones que conforman RStudio son cuatro:

- la fuente (en la parte superior izquierda),
- el entorno (parte superior derecha),
- la consola (parte inferior izquierda) y
- la sección de "documentos, gráficos, paquetes y ayuda" (parte inferior derecha).

```{r fig.cap= "R", fig.align='center', out.width = '80%', echo=FALSE}
knitr::include_graphics("imagenes/RStudio_partes.png")
```

## RStudio 

Cuando uno abre R studio, de forma predeterminada, se ve de la siguiente manera:

```{r fig.cap= "R", fig.align='center', out.width = '80%', echo=FALSE}
knitr::include_graphics("imagenes/rstudio_entorno.png")
```

* Básicamente, la interfaz se compone de diferentes paneles. Sobre el lado izquierdo hay un panel grande y en el lado derecho hay dos paneles más pequeños. Al comenzar a trabajar en R Studio, habrá un cuarto panel que se activa cada vez que se abre un nuevo documento.

* Al crear ese nuevo archivo hay cuatro paneles: dos a la izquierda y dos a la derecha. Es posible ajustar estos paneles moviendo la barra que los separa. También se puede deslizar el divisor del medio para ajustar el ancho de los paneles y en el lado derecho también es posible ajustar las alturas relativas de estos paneles. 

* En la esquina de cada panel hay un botón de minimizar, para ocultar cualquier panel. Se puede maximizar nuevamente haciendo clic sobre el mismo o en el botón que muestra dos paneles.

* Esta es la forma predeterminada para configurar R Studio. Cualquier documento que se cree se encontrará en el panel superior **izquierdo** y luego en el inferior izquierdo está la consola de R, que es un área donde se pueden escribir comandos en R directamente. En el lado **derecho**, el panel superior es básicamente información sobre el entorno de nuestro estudio, el entorno en el que está trabajando.

* En la parte inferior derecha hay un panel que tiene varias pestañas. El primero le permite ver la estructura de su archivo, por lo que es un poco como una ventana estándar que se usa para navegar por tus archivos.

```{r fig.cap= "R", fig.align='center', out.width = '80%', echo=FALSE}
knitr::include_graphics("imagenes/panel_der_inf.png")
```

* Hay una pestaña que enumera los paquetes que se han instalado. 

```{r fig.cap= "R", fig.align='center', out.width = '80%', echo=FALSE}
knitr::include_graphics("imagenes/R_packages.png")
```

* La otra es una pestaña de ayuda, ya que en R, si uno desea ayuda sobre cualquier cosa, se la puede obtener escribiendo un signo de interrogación y luego el nombre del objeto sobre el que desea ayuda:

```{r}
?mean
```

* Se puede ver que al ejecutar ese comando, se obtiene un archivo de ayuda sobre la media. También es posible obtener uno sobre la mediana, y así sucesivamente. 

```{r}
?median
```

Se obtendrá:

```{r fig.cap= "R", fig.align='center', out.width = '80%', echo=FALSE}
knitr::include_graphics("imagenes/uso_help.png")
```

* Entonces, si uno quiere ayuda, aparecerá en dicha pestaña. Hay que tener en cuenta que es posible modificar la configuración de estos paneles. Los pasos para hacerlo son:

> Menú > Herramientas

* Desde una PC, dentro del Menú se encuentran las 'Opciones'; desde una Mac se llama 'Opciones globales'. Este menú ofrece todo tipo de posibilidades para configurar R Studio y el entorno. Para cambiar la ubicación de la consola y el entorno, hay que clicar arriba, donde dice 'Entorno', sobre el cuadro desplegable y aplicarlo. Al volver, se verá en el lado izquierdo, el documento en el que estamos trabajando y debajo, el panel de 'Entorno'.

```{r fig.cap= "R", fig.align='center', out.width = '80%', echo=FALSE}
knitr::include_graphics("imagenes/global_opt.png")
```

* También es posible cambiar el color del esquema, dentro de las 'Opciones globales' puedes ver algunas opciones de apariencia. El tema predeterminado tiene blanco de fondo con un texto en negro. Pero no es el único, sino que existen diferentes temas que se pueden aplicar.

```{r fig.cap= "R", fig.align='center', out.width = '80%', echo=FALSE}
knitr::include_graphics("imagenes/color_schema.png")
```

## Workflow

En esta sección hablaremos sobre el flujo de trabajo ('workflow') en R Studio. Existen muchas cosas sobre el trabajo en R que la gente encuentra confusas. Sin embargo, hay formas en las que puede simplificar este problema: sistematizando una buena práctica del flujo de trabajo desde el principio.

## Proyectos R Studio

Una de las cuestiones más comunes que generan dificultades en R, es debido a que no provee las facilidades de un software estándar con el cual apuntar y hacer clic dentro de la misma interfaz, pero al utilizar R y R Studio, se nos dificulta tener que acceder a los archivos y guardarlos utilizando rutas de archivo, en especial cuando esas rutas ('paths') son extensas. 

La forma más sencilla de minimizar esta dificultad es trabajar con lo que llamamos un documento de tipo **proyecto de R Studio**. Este es el primer paso a seguir: usar los archivos de proyecto de R Studio. Antes que nada, ¿Qué es un archivo de proyecto de R Studio? 
- Es un archivo creado por R studio que tiene una extensión de .Rproj, y esencialmente lo que hace es almacenar información sobre la carpeta que lo contiene. Así que para guardar este archivo de proyecto dentro de una carpeta en particular, hay que tener en cuenta que dentro del proyecto se guardará información sobre la carpeta que se encuentra en su sistema de archivos, y también guardará información sobre el estado anterior del proyecto. Cuando se genera archivo de proyecto, primero se abrirá en R Studio y de este modo se puede acceder a la información sobre la carpeta en la que se encuentra almacenado este proyecto. 

## Organización

Una de las cosas clave es que, al trabajar con archivos de proyecto, es necesario organizarse. Una forma sencilla de trabajar con R Studio es tener un proceso pre-establecido por el que pasar cada vez que se inicie un nuevo proyecto en R Studio. El proceso que se sugiere en este libro consiste en:

- Crear un nuevo proyecto de R Studio, por el cual se va a crear una carpeta dentro del directorio local.

- Luego, dentro de esa carpeta crear una sub-carpeta llamada 'datos'. Ahí es donde se guardarán todos los archivos de datos relacionados con el proyecto. 

- También, crear una carpeta llamada 'r_docs' que es donde se guardan todos los documentos de R y de R Studio.

- En caso que haya imágenes o medios asociados con el proyecto, se aconseja generar una carpeta llamada 'imágenes'. 

En resumen, siguiendo el tipo de organización aquí propuesta, hay un directorio donde se guardan todos los proyectos de R Studio. Tal como se aclaró antes: la información del proyecto se almacena dentro de una carpeta, donde a su vez hay tres carpetas más: una donde se encuentran los archivos de datos, otra donde guardar todos los documentos de R y R Studio, y una última carpeta para las imágenes. Además, dentro de esa carpeta grande habrá un archivo de 'R Studio project', con el nombre que el usuario le haya asignado.

## Utilidad

¿Por qué este procedimiento de organización del flujo de trabajo es útil? Porque respetando la estructura de las carpetas, es posible encontrar los archivos de manera sencilla, optimizando tiempo y espacio. Esta estructura se puede ver en la ruta del archivo, que será similar a /Usuarios/Nombreusuario/Documentos/RProjects...etc. Esta es una ruta a un archivo de datos que se almacena en el disco duro, en la unidad correspondiente, que puede ser C o U, por ejemplo.

**Desventaja 1**

- Dentro de una carpeta llamada "Usuarios", ingresando a una carpeta denominada "tunombre" (aquí cada uno puede colocar su propio nombre de usuario), dentro de la carpeta llamada "Documentos" y luego, dentro de otra carpeta se encuentra el nuevo proyecto creado. En esta última, finalmente, está la subcarpeta de "datos". Por lo tanto, cada vez que se desee acceder a ese archivo de datos, tanto para cargarlo como guardarlo, se debe llamar a esa gran cadena de texto, que es la ruta al archivo, lo cual puede resultar muy molesto.

**Desventaja 2**

- Si se cambia de la computadora donde fue creado un archivo de R a otra que no tenga el sistema de archivos que se ha descrito en este libro, entonces se debe reescribir todo el código de R para poder acceder al archivo deseado. Esto es porque podría estar guardado en una ubicación  diferente a la de mi archivo local. Al usar un proyecto de R Studio puedo usar lo que se conoce como "rutas relativas". También, hay un camino mucho más corto que implica colocar dos puntos y una barra al inicio de la ruta. Los puntos representan la carpeta del proyecto que se encuentra en una ubicación diferente a la del archivo que se está editando. Dondequiera que esa carpeta esté almacenada, no es necesario saberlo porque el proyecto de R Studio redirige automáticamente allí cuando se implementan los puntos. Todo lo que hay que hacer es poner los puntos seguidos de una barra, luego el nombre de la carpeta de datos y de nuevo barra, seguido el nombre del archivo al que se intenta acceder. Por ejemplo, ../nombrecarpeta/nombrearchivo.rmd

Ahora se presenta un segundo ejemplo utilizando la estructura de carpetas aquí propuesta. Si se almacenan los archivos de R Studio dentro de una carpeta llamada "docs_r", es necesario salir de la misma y luego volver a "mis_datos". Eso es lo que los puntos dobles hacen: subir de nivel. En concreto, las acciones que lleva a cabo son salir de 'docs_r' e ir a la carpeta de datos. Sin embargo, cuando hay muchos archivos, esto puede resultar un poco engorroso.

## Crear un Proyecto de R Studio

- Lo primero es seleccionar un directorio en algún directorio local de nuestro ordenador. 

- Luego abrir R studio e ir al menú "Archivo'', hacer clic en "Nuevo proyecto" y así se obtendrá un cuadro de diálogo. Se puede crear un nuevo directorio con el proyecto o si ya existe un directorio que se pueda convertir en un proyecto de R Studio, también se puede seleccionar un directorio existente. 

En siguiente paso es seleccionar en la opción superior para generar un proyecto, y luego crear el proyecto nuevo como un subdirectorio.

- Lo siguiente es buscar dónde guardar este proyecto. Si se desea mantener todos los proyectos juntos es necesario crear una carpeta llamada “proyectosr"donde colocar todos los proyectos de R. Como nombre del directorio se solicita el nombre del archivo de proyecto de R Studio, en este caso puede llamarse “primer_proyecto”. 

- Como resultado, a pesar de que nada parece cambiar, en la pestaña de archivos (margen inferior), se notifica que uno se encuentra en la carpeta o directorio seleccionados. En este casom, dentro de la carpeta de todos nuestros proyectos de R y, a su vez, en la carpeta llamada “primer_proyecto” que es como hemos nombrado a este proyecto. Se puede navegar dentro del proyecto desde aquí.

**Recordatorio** 

- R distingue entre mayúsculas y minúsculas, por lo que siempre es recomendable escribir todo en minúsculas.

## Crear un archivo de R

Lo siguiente es crear un documento en el que queremos trabajar. En este libro usaremos el ejemplo de un archivo de Markdown de R, aunque existen otros tipos de archivos de R. 

- Vamos a crear un nuevo archivo de tipo “R markdown”. Al seleccionar sobre el botón de crear archivo (margen superior izquierdo, identificado con el signo “+” en color verde), aparecerá una ventana. Allí, colocaremos el título al documento, que se puede llamar “primer_documento”, y también el nombre del autor. No es necesario poner el nombre del autor, se puede dejar ese espacio en blanco. Y por último, se selecciona el "Formato de salida", que crea el archivo de R Markdown. 

- Es posible ver que en el nuevo documento de R markdown ya hay texto, que es un ejemplo de documento, el cual se puede borrar en su totalidad y cargar la información que se desee. En un documento de R Markdown, las áreas grises son lo que se conoce como “fragmentos de código” o “chunks”. Allí es donde se dan instrucciones a R, como comandos o fórmulas, sobre las que trabaja el programa. 

- Fuera, en el área blanca, se puede escribir texto. Presentamos un ejemplo simple, en el que se inserta un fragmento de código de varias maneras. A través del Menú, se puede ir a:

También hay atajos de teclado que puedes usar: 

```r
* Insert code chunk in PC: Ctrl+Alt+I
* Insert code chunk in Max/Linux: Cmd+Option+I
```

**En resumen**, cuando haya un nuevo proyecto en el que se esté trabajando, se recomienda generar un nuevo archivo de proyecto en R Studio. Dentro de esa carpeta, generar otra carpeta donde almacenar los datos (que aquí hemos llamado “r_docs”, como los documentos de R markdown.

## R markdown

La manera más sencilla de interactuar con R es a través de documentos conocidos como documentos de **R Markdown**, que ya hemos visto a modo de ejemplo en la sección anterior. Estos documentos son una combinación de varios tipos de información. Por un lado, lo que se conoce como “fragmentos de código” (code chunks), que son un tipo de ventanas en R donde se escribe código para ejecutar análisis. También, fuera de esos fragmentos de código podemos escribir texto. En esta sección se explicará con mayor detalle cómo formatear el texto en el documento de R. Para ello, debemos seguir los pasos:

- Abrir el primer proyecto de R Studio, el cual estará alojado en el directorio de nuestro equipo local llamado "proyectos_r" o similar.
- Dentro de esa carpeta, seleccionar el documento llamado "primer_proyecto.Rproj".
- Otras carpetas que encontramos allí son: "datos" e "imagenes".
- Descargar una foto de Internet o seleccionar una foto antigua que se encuentre en la computadora y guardarla en nuestra carpeta de "imagenes"
- Crear un nuevo documento clicando en la barra superior de RStudio llamada "documentos", y luego en R Markdown. Otra opción es clicar sobre el ícono de una hoja blanca con un círculo verde en la esquina superior izquierda de la barra de herramientas de R Studio. Aparecerá una ventana, rellenamos con el título y el autor. Luego, guardarlo con un nombre al archivo y almacenarlo en la carpeta del proyecto, en "documentos_r".
- Nuestro documento posee un template, clicar sobre el botón "Knit", acompañado de un ícono de un ovillo de lana y unas agujas de tejer (barra superior izquierda). Se obtendrá un archivo de tipo HTML con el título, la fecha y el autor, que podemos eliminar en caso de ser necesario.

## Agregar texto

La cantidad de símbolos de numeral (#) indica el nivel del título o subtítulo que se desea editar. Es necesario dejar un espacio entre el numeral y el texto que escribamos para obtener los títulos en negrita y sin el símbolo. Se debe utilizar el primer nivel de títulos en cada documento R Markdown. Probamos los niveles diferentes en un documento de R Markdown de la siguiente manera:

```{r eval=FALSE}
 # Título nivel 1
 ## Título nivel 2
 ### Título nivel 3
 #### Título nivel 4
```

**Recordatorio** clicar control + S constantemente para guardar los cambios efectuados en el documento, a medida que se trabaja sobre él.

## Listas

* Se utiliza el símbolo del asterisco para realizar bullet-points (* Bullet)
* Para un sub-bullet se usa el signo sumatorio (+ Sub-bullet)
* Para un tercer nivel de sub-bullet, el signo de restas (- Tercer nivel de bullets)
* Es importante, además de los símbolos, indentar las líneas cada vez que reduzca mi número de bullets en una lista. Espaciar entre el símbolo y el contenido de la lista. Además hay que dejar un espacio una vez finalizada la lista y antes de comenzar otra nueva.
* Se puede hacer una prueba creando una lista sobre "Materias que no me gustan de mi carrera". Para presentar nuestra lista, se debe agregar una línea de texto común, con su descripción. 
* Luego, clicar en "Knit" para generar el documento.

## Editar texto

* Para incluir algún formato de texto, se deben utilizar los siguientes símbolos al inicio y al final de cada palabra o grupo de palabras que se desea editar:

```{r eval=FALSE}
*Itálicas*
	
**Resaltado**
	
Texto ^superscript^
	
Texto ~subscript~

```
## Insertar imágenes

* Las imágenes son fáciles de agregar, siguiendo las líneas de código siguiente:

```{r eval=FALSE}
![Caption for image](filepath_for_image)

![Figura 1: Mi perra hermosa: Nina]
(../materiales/imagenes/nina.png)
```

* Se puede hacer una prueba agregando una foto que nos guste.
* Se puede colocar el epígrafe de la foto del siguiente modo:

```{r eval=FALSE}
![Nina](imagenes/nina.png){width=50%}
```

* También es posible seleccionar el tamaño de la imagen.

## Enlaces

* Para incluir un enlace se debe:

```{r eval=FALSE}
Incluir entre corchetes [lo que aparecerá] en el texto y, seguido, entre paréntesis (el enlace que redirige al sitio que se seleccione)
```

## Tips para escribir código en R

- A la hora de escribir en este lenguaje de programación, hay que conocer algunas funcionalidades que nos permiten resolver acciones claves y responder a dudas de manera sencilla. Para obtener información sobre una función concreta, se pueden utilizar alguna de las siguientes funciones:

```{r setup1, include=TRUE}
help(solve)
```

```{r setup2, include=TRUE}
?solve
```

```{r setup3, include=TRUE}
help("[[")
```

```{r}
getRversion()
```

```{r setup5, include=TRUE}
?help
```

- Las mayúsculas y minúsculas importan. R es un lenguaje de expresiones que es sensible a las mismas y responde de manera diferente a cada una.

- Las órdenes elementales consisten en expresiones o en asignaciones. Las órdenes se separan con un punto y coma, (‘;’), o cambiando de línea.

- Las flechas verticales permiten recuperar órdenes previas y ejecutarlas y las horizontales nos permiten desplazarnos dentro de una orden para corregirla.

- Para eliminar objetos puede utilizar la orden “rm”, por ejemplo: 

```r
 rm(x, y, z, cabello, perro, bonito)
```

## Funciones y comandos elementales

Las entidades que crea R durante una sesión de trabajo se denominan objetos. Estos pueden ser números, cadenas, vectores, matrices, funciones o estructuras más generales construidas a partir de estos elementos. Estos objetos se guardan por nombre y se almacenan en un área dedicada llamada espacio de trabajo o espacio de trabajo. En cualquier momento, es posible verificar los objetos disponibles en el espacio de trabajo usando el comando:

```r
ls()
```

Para eliminar un objeto del espacio de trabajo, use la función rm(). La función espera el nombre del objeto que desea eliminar como argumento. Suponiendo que hay un objeto llamado "cosa", puede eliminarlo con el comando:

```r
rm(cosa)
```

Al iniciar una nueva sesión de trabajo, se recomienda retirar los objetos existentes en el área de trabajo. Un comando útil para este propósito es:

```r
rm (lista = ls ()) 
```
o, alternativamente, rm(lista = objetos ()). Puede almacenar el espacio de trabajo con la función:

```r
save.image ()
```

Esto guarda todos los objetos contenidos en el espacio de trabajo en un archivo binario ".Rdata". La opción predeterminada se puede cambiar especificando en la llamada a save.image () el nombre, por ejemplo, "myfile.Rdata", que desea darle al archivo.

```r
save.image (archive = "ilmiofile.Rdata")
```

El espacio de trabajo original se puede restaurar con la ayuda de la función:

```r
load(".RData")
```

o, si ha optado por un nombre diferente al predeterminado:

```r
load("ilmiofile.Rdata")
```

Las funciones:

```r
savehistory()
```

```r
loadhistory()
```

permiten guardar en formato ASCII y recargar en R el historial de los comandos enviados. El argumento de archivo que permite especificar un nombre que no sea la elección predeterminada, es ".Rhistory".

Finalmente, la función setwd () permite cambiar los libros de trabajo. Es una buena idea dedicar una carpeta separada a cada proyecto en el que esté trabajando para evitar la superposición de datos. El directorio de trabajo actual se puede ver con el comando getwd ().

Los comandos básicos constan de expresiones o asignaciones. Si el comando es una expresión, R devuelve el resultado de la evaluación, como se muestra en los siguientes ejemplos:

```{r setup6, include=TRUE}
12 > 10
```

```{r setup7, include=TRUE}
1+2+3
```

```{r setup8, include=TRUE}
2+3*4
```

```{r setup9, include=TRUE}
3/2 + 1
```

```{r setup10, include=TRUE}
2 + (3 * 4)
```

```{r setup11, include=TRUE}
(2 + 3) * 4
```

```{r setup12, include=TRUE}
4 * 3^3
```

Todas las funciones matemáticas que normalmente se encuentran en una calculadora de bolsillo están disponibles en R en forma de funciones básicas, que se recuerdan en la siguiente tabla:

sqrt ---> raíz cuadrada
abs ---> valor absoluto
sin,cos,tan ---> funciones trigonométricas
asin,acos,atan ---> funciones trigonométricas inversas
exp,log ---> exponenciales y logaritmos naturales

```{r setup13, include=TRUE}
sqrt(2)
```

```{r setup14, include=TRUE}
sin(3.14159)
```

```{r setup15, include=TRUE}
sin(pi)
```

```{r setup16, include=TRUE}
sqrt(sin(45 * pi/180))
```

Una asignación evalúa una expresión guardando el resultado en un objeto con un nombre. La asignación se realiza mediante el símbolo <- o el símbolo =. También se puede asignar de izquierda a derecha con el símbolo ->. El resultado de una asignación no se muestra automáticamente. El usuario puede verlo recordando el nombre del objeto. Los objetos creados a través de una asignación se pueden reutilizar en expresiones y asignaciones posteriores, como se muestra en los siguientes ejemplos:

```{r setup17, include=TRUE}
x <- sqrt(2) 
x
```

```{r setup18, include=TRUE}
x^3
```

```{r setup19, include=TRUE}
y <- x^3
```

```{r setup20, include=TRUE}
x <- 10 
x > 10
```

```{r setup21, include=TRUE}
x <= 10
```

```{r setup22, include=TRUE}
tf <- x > 10  
tf
```

## Valores y vectores

Para asignarle un valor a una variable, recuerda que no es necesario utilizar espacios ni símbolos, excepto # . o _ en el nombre de la variable:

```r
mi_valor <- 30 # número
un_valor <- "vaca" # caracteres
el_valor <- FALSE # booleano
```

Para crear un vector, usamos la función c():

```{r setup23, include=TRUE}
x <- c(2, 3, 5, 7, 11)
x
```

El vector puede contener texto o valores numéricos:

```r
mi_vector <- c(6,12,80,120)
mi_vector <- c("María","Esteban","Juan")
```

Si el vector contiene muchos elementos, puede ser más conveniente usar la función scan (), que le permite ingresarlos uno por uno:

```{r
x <- scan()
1: 1
2: 6
3: 3
4: 4
5:

x
```

```{r
x <- scan()

1: 23; 34; 32
4: 33; 88; 44
7:
        
```

Para crear una secuencia de números de a a b, puede usar el comando a: b.

```{r setup26, include=TRUE}
xx <- 1:10

xx
```

```{r setup27, include=TRUE}
xx <- 100:1 
xx
```

También se pueden crear vectores que contienen elementos repetidos.

```{r setup28, include=TRUE}
rep(2, times = 3)
```

```{r setup29, include=TRUE}
rep(2, 3)
```

```{r setup30, include=TRUE}
a = c(rep(2, 3), 4, 5, rep(1, 5)) 
a
```
 
Las operaciones aritméticas y lógicas básicas que se aplican a los escalares se pueden aplicar a los vectores.
 
```{r setup31, include=TRUE}
x <- 1:10 
x*2
```

Los elementos de un vector se pueden extraer utilizando corchetes [] e indicando la posición del elemento a extraer entre corchetes.

```{r setup32, include=TRUE}
xx[7] 
```

Incluso se pueden extraer más elementos al mismo tiempo.

```{r setup33, include=TRUE}
xx[c(2, 3, 5, 7, 11)]
```

```{r setup34, include=TRUE}
xx[85:91]
```

También se pueden guardar en nuevos vectores:

```{r setup35, include=TRUE}
yy <- xx[c(1, 2, 4, 8, 16, 32, 64)] 
yy
```

Si los indicadores entre corchetes van precedidos de un signo negativo, los elementos correspondientes se eliminan del vector.

```{r setup36, include=TRUE}
x <- c(1, 2, 4, 8, 16, 32) 
x
```

```{r setup37, include=TRUE}
x[-4]
```

Al ingresar una variable a la consola, esta mostrará su contenido:

```r
mi_vector
```

También podemos utilizar el operador ':' para obtener todos los números en un rango, por ejemplo, entre 1 y 20:

```r
mi_vector <- 1:20
```

Otra herramieta útil es la función rep(), que nos permite repetir un valor específico, dado el número de veces en un vector:

```r
repeated_values <- rep(23, times = 50)
````

También se pueden indexar elementos de un vector, dando la posición del elemento en el vector. Hay que recordar que todos los índices en R comienzan en 1 y no en 0:

```r
mi_vector[5]
```

La función 'length()' sirve para obtener el número de lementos en un vector o en una lista de objetos:

```r
length(mi_vector)
```

## Matrices

Una variable indexada (*array*) es una colección de datos, por ejemplo numéricos, indexada por varios índices. R permite crear y manipular variables indexadas en general y en particular, matrices.

Las matrices se crean utilizando la función matrix (). En su forma más simple, el uso de la función implica especificar un vector que contiene los elementos de la matriz y el número de filas o columnas de la matriz.

```{r setup38, include=TRUE}
x <- matrix(c(2, 3, 5, 7, 11, 13), nrow = 3) 
x
```

```{r setup39, include=TRUE}
 x <- matrix(c(2, 3, 5, 7, 11, 13), ncol = 2) 
 x
```

Las *array* pueden verse como matrices "multidimensionales". Se crean usando la función array (). En su forma más simple, el uso de la función implica especificar un vector que contiene los elementos de la matriz y el número de elementos para cada dimensión usando el argumento dim.

```r
x <- 1:20
ax <- array(x, dim = c(5, 2, 2)) > ax
,,1
```

Hay que tener en cuenta que, de forma predeterminada, las matrices se forman insertando los distintos elementos por columna. Obviamente, la matriz se puede adquirir desde un archivo externo. Por ejemplo, suponga que el archivo matdata tiene el siguiente contenido.

```r
1,24,32,36,33
2,16,44,34,33
3,20,31,43,32
4,23,35,37,35
5,27,40,40,31
6,19,43,32,37
```

El contenido del archivo se puede adquirir y asignar a una matriz de 6 × 5 con los comandos:

```r
x2 <- scan("matdata", sep = ",")

mx <- matrix(x2, ncol = 5, byrow = TRUE)
mx
```

El argumento byrow = TRUE especifica que el contenido debe adquirirse por fila y no por columna.

La función dim () devuelve el tamaño (número de filas y número de columnas) de la matriz indicada como argumento.

```{r
dim (mx)
```

En cuanto a los vectores, los elementos de una matriz se pueden extraer utilizando paréntesis []. Para extraer un elemento de una matriz, se debe especificar su posición de fila y columna.

```{r setup42, include=TRUE}
x[2, 1]
```

```{r setup43, include=TRUE}
x[2, 2]
```

Para extraer una fila o columna completa, simplemente especificar su posición:

```{r setup44, include=TRUE}
x[, 1]
```

```{r setup45, include=TRUE}
x[3, ]
```

Se pueden extraer subconjuntos de filas y / o columnas.

```{r setup46, include=TRUE}
x <- matrix(1:16, ncol = 4) 
	x
```

Las matrices pueden verse como matrices "multidimensionales". Se crean usando la función array (). En su forma más simple, el uso de la función implica especificar un vector que contiene los elementos de la matriz y el número de elementos para cada dimensión usando el argumento dim.

```{r
x <- 1:20
ax <- array(x, dim = c(5, 2, 2)) 
ax
,,1
```

Se puede crear una matriz compuesta por números usualmente, usando la funcion 'matrix()':

```r
mi_matriz <- matrix(data = 1:10, # qué se incuye en la matriz
                    ncol = 5, # número de columnas
                    nrow = 20, # número de filas
                    byrow = TRUE) # incluir el input
```

Podemos indexar elementos de matrices en múltiples modos:

```r
mi_matriz[1,] # las filas van seguidas de una coma. Primero filas y luego columnas[row,colum]
mi_matriz[,5] # columnas detrás de la coma
mi_matriz[3,3]

```

Se pueden crear nuevas variables a partir de secciones de matrices:

```r
val <- mi_matriz[3,3]
val <- mi_matriz[,3]
```

Hay algunas funciones útiles que podemos aprender para conocer más a fondo la matriz:

````r
sum(mi_matriz) # La suma de los elementos de la matris
nrow(mi_matriz) # El número de filas de la matriz
ncol(mi_matriz) # El número de columnas de la matriz
```

R tiene un conjunto de tipos de datos suficientemente diversificado para ser adecuado en la mayor cantidad de análisis. Los tipos que encontraremos con mayor frecuencia son lógicos (con los modos VERDADERO y FALSO), de caracteres (cadenas de caracteres) y numéricos. Las funciones con el prefijo is.type.of.data verifican a qué tipo de datos pertenece el objeto especificado como argumento.

```{r setup47, include=TRUE}
x1 <- 1:3
is.logical(x1)
```

Para combinar objetos que no comparten la misma estructura, como cadenas de caracteres y vectores, es necesario utilizar una lista. Este es un tipo más general de estructura de vectores y matrices.


```r
lista1 <- list(x1, x2)  
lista1

[[1]]
[1] 1 2 3
[[2]]
[1] "A" "B" "C"

```

Una de las posibles formas de acceder a la información de una lista es mediante corchetes dobles.

```r
lista1[[1]]
[1] 1 2 3
```

```r
lista1[[2]]
[1] "A" "B" "C"
```

Es posible, en la fase de creación de una lista, asignar un nombre a cada uno de sus componentes. Si los componentes de una lista tienen un nombre, se puede acceder a ellos, y posteriormente a los elementos que los componen, mediante el símbolo $.

```r
lista2 <- list(comp1 = x1, comp2 = x2)
lista2

$comp1
[1] 1 2 3

$comp2
[1] "A" "B" "C"

lista2$comp2
[1] "A" "B" "C"

lista2$comp2[3]

[1] "C"

```

Devuelve el valor NULL si no se han asignado. Además de NULL, TRUE y FALSE, R tiene otros valores "reservados".

Probablemente, el más relevante para nuestros propósitos es NA, que indica un valor faltante. No es raro encontrar valores NaN (número indefinido) e Inf (infinito).

## Subsetting

La forma más básica de hacer un “subsetting” es extraer un grupo de elementos de un vector, por ejemplo:

```r
mi_vector <- 1:10
mi_vector[3:5] # extract the 3rd to 5th elements
new_vector <- mi_vector[3:5] # assign them to a new vector
mi_vector[c(1,2,9)] # extract the 1st, 2nd, and 9th elements in a vector:
````

También se puede usar la función c() para quitar algunos subsets (subsecciones) de la matriz:

```r
mi_matriz[c(1:3,5),c(2,4)]
```

Nótese la diferencia entre [[]] y [] en las listas:

```r
nueva_lista <- mi_lista[1] # Devuelve la lista
nuevo_valor <-  mi_lista[[1]] # Devuelve un objeto que estaba en la lista
```

Usar [] para el subset de una lista:

```r
nueva_lista <- mi_lista[1:2]
```

## Subsetting inteligente

La función 'winch()' nos permite identificar observaciones que cumplen ciettos criterios, que nosotros disponemos. Usando el operador '$' que nos habilita a acceder a una variable de nuestro data frame, según su nombre:

```r
which(mis_datos$Notas == "A")
```
Ahora podemos crear un dataset que sólo incluya a los estudiantes que obtuvieron A o B como natas, guardando los índices de sus notas, luego usando para extraerlos de los datos totales:

```r
A_estudiantes <- which(mis_datos$notas == "A")
B_estudiantes <- which(mis_datos$notas == "B")
estudiantes_dataset_reducido <- c(A_estudiantes, B_estudiantes)
```

Ahora se selecciona el vector para indexar únicamente algunas filas: para ello, extraerlas y guardarlas como objetos. Recuerda: si se indexa por [fila, columna] y dejamos un campo vacío, tomaremos la fila ó columna entera.

```r
reduced_data <- mis_datos[estudiantes_for_reduced_dataset,]
```


---
knit: "bookdown::preview_chapter"
---

## Cargar datos en R

Cuando la intención es hacer una investigación utilizando datos secundarios, lo primero que debemos hacer (una vez diseñadas las preguntas de investigación y nuestra/s hipótesis), es seleccionar los datos con los que vamos a trabajar. En esta ocasión, se presenta cómo abrir una base de datos en R.

## Data Frames

Como ejemplo, se construyen algunos datos...

```r
numero_estudiante <- c(1:10)

notas <- c("A","B","C","A","C","F","D","B","B","A")

clase <- c(rep(0,times = 5),rep(1,times = 5))

comida_gratis <- rep(TRUE,times = 10)
```

Ahora podemos unir los vectores que hemos creado antes para hacer un 'data.frame', que es uno de los tipos de data más comunes en R. Los data frames sirven para contener muchos tipos de valores (sean textuales o numéricos) y además sus columnas son fáciles de indexar por nombre utilizando el operador '$'.

Para evitar que nuestros notas en letras se conviertan en factores de variables, es decir, que se transformen en una variable categórica de R, se debe implementar el argumento 'stringsAsFactors = FALSE' 

```r
mis_datos <- data.frame(numero_estudiante,
                      notas,
                      clase,
                      comida_gratis,
                      stringsAsFactors = FALSE)
```

También es posible designar el nombre de las columnas:

```r
nombrecol(mis_datos) <- c("numero_estudiante", "notas","clase","comida_gratis")
```

o bien, colocarle nombre a las filas:

```r
nombrefila(mis_datos) <- LETTERS[11:20]
```

La indexación funciona de la misma manera para las matrices, pero con un pequeño cambio:

```r
mis_datos[,1]
mis_datos[2,4]
mis_datos$numero_estudiante # $ Indexación de columnas
mis_datos$notas[3] # Tratar $ Indexación de columnas como vectores
```

## Hacer una lista de estructuras de datos

Para crear una lista vacía, utilizamos la función 'vector()'.

```r
mi_lista <- vector(mode = "lista", length = 10)
```

También podemos crear una lista a partir de objetos. Cada entrada puede ser llamada una lista, igual que hacemos con un data.frame:

```r
mi_lista <- list(num = 10,
                animal = "vaca",
                vec = c(1:10),
                dat = mis_datos)

```

Otra opción es crear una lista vacía y luego llenarla usando el operador '$':

```r
mi_lista <- list()
```

Una vez creada, vamos a llenarla de datos:

```r
mi_lista$num = 10
mi_lista$dat = mis_datos
mi_lista$cancion_favo = "Malamente"
```

Además, se pueden pegar listas al final de otras listas, si usamos la función 'append()'

```r
mi_lista <- append(mi_list, list(list(27,14,"perro")))
```

Ahora observamos el contenido de nuestra lista:

```r
print(my_list)
```

Y extraemos uno de los elementos usando la indexación con [[]]:

```r
mi_segundo_data_frame <- mi_lista[[4]]
mi_lista$dat
```

## Importar datos

Para trabajar y operar en R con la finalidad de obtener el resultado deseado, y en última instancia, realizar análisis, necesitamos usar datos. 

## Fuentes de datos

Existen numerosas fuentes de las que podemos valernos para obtener datos secundarios. En la sección anterior, se realizó un breve recorrido sobre datos primarios. Estos últimos, son aquellos que generamos nosotros mismos. Por ejemplo, se puede realizar una encuesta y, en base a los resultados obtenidos, generar una base de datos que nos sirva de punto de partida para luego, incurrir en el análisis.

Para ello, se deben seguir los siguientes pasos: utilizar una base de datos como archivo de Excel y moverlo a la carpeta del primer proyecto que creamos en la sesión anterior, para luego incorporarla a la sub-carpeta llamada "datos".

## Importar datos desde Excel

Un tipo de formato muy conocido es el de Excel, cuyas extensiones pueden ser .xls y .xlsx, siendo la primera más vieja que la segunda.

El objetivo es visualizar estos datos en nuestra ventana del entonrno de RStudio. Para ello, se necesita un paquete que ayude a leer estos datos, el cual se obtiene siguiendo los siguientes pasos:

1. ingresar a la carpeta del proyecto sobre el que estamos trabajando:

- clicar sobre "primer_proyecto.rproj" (en lugar del nombre "primer proyecto, debes insertar en su lugar el nombre de tu proyecto en particular, en este caso, se llama "primer_proyecto". La extensión del archivo debe ser .rproj, que es la que tienen todos los proyectos en R)

2. I a la consola y ejecutar el siguiente comando:

```r
install.packages("readxl")
```

Este paquete permite trabajar con archivos de Excel específicamente.

3. Abrir la librería del paquete que recién instalamos, ejecutando el siguiente comando, nuevamente en la consola:

```r
library(readxl)
```

Nótese que para abrir la librería no se precisan comillas entre los paréntesis, a diferencia de durante su instalación (detallada en el paso 2).

4. Colocar la ruta en donde se encuentra mi base de datos. En este caso, el directorio donde yo poseo mi encuesta especificada es: "/Users/sofiajaime/Documents/rprojects/primer_proyecto/datos/encuesta1.xlsx". Debes tener en cuenta que esta ruta es específica de cada usuario, en su ordenador local. 

Es posible obtener esta ruta/path fácilmente yendo a la capreta donde este se encuentra, clicando en el botón derecho sobre la misma y en la opción "Propiedades" en el caso de un PC o bien en "Obtener información" o "Get info" si tienes un Mac. 

Luego, simplemente hay que denominar al objeto "encuesta", en este caso. Seguido, colocar una función "read_excel" y entre paréntesis y comillas, pegamos la ruta **nuestra** que dará acceso al archivo seleccionado. La línea de código es la siguiente:

```r
encuesta <- read_excel("/Users/sofiajaime/Documents/rprojects/primer_proyecto/datos/encuesta1.xlsx")
```

5. Si se han realizado los pasos anteriores correctamente, aparecerá nuestra base de datos en el entorno o environment de RStudio. Allí es posible ver cuántas observaciones y cuántas variables reconoce el programa dentro de nuestra base. Al clicar sobre la misma se abrirá un archivo de R con los datos de la encuesta especificada. Esto sirve para visualizar de manera más sencilla toda la información que contiene.

Para comprobar que el trabajo se haya realizado bien, podemos "llamar" a nuestro objeto "encuesta" de la siguiente manera:

```r
encuesta
```
De este modo, aparecerán nuestros datos en la consola misma.

```{r fig.cap= "Importar Datos de Excel", fig.align='center', out.width = '80%', echo=FALSE}
knitr::include_graphics("imagenes/encuesta_1.png")
```

**Sobre algunos errores comunes**: a veces, se confunden en detalles que, en R, hacen la diferencia. Algunos errores comunes son:

- *Seleccionar las barras incorrectas (/ ó \) según la computadora*: en la ruta que da acceso a los documentos que se quieren utilizar, hay muchas barras. Es necesario colocar las correctas según la computadora en el que esté trabajando, y además, que todas ellas estén en la misma dirección. Si utilizo estas barras: /, deben estas todas en la misma dirección en la línea de código que esté escribiendo, porque si hay inconsistencias (utilizo ambas de manera mezclada) R no podrá leer el archivo que deseamos que lea.

- *Ruta errónea: se debe comprobar que nuestra ruta*, que es fácil de encontrar, tal como se especifica en el paso 4 que se encuentra más arriba.

- *Símbolos incorrectos, excedentes o faltantes*: un símbolo de más o uno ausente pueden hacer que R no entienda lo que le "ordenamos". Por ello, verificar que todos los símbolos estén correctamente escritos, en el lugar que deben estar, es muy importante.

